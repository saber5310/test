<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title> ليجــــــا شوت </title>
        <link rel="stylesheet" href="api-football.css">
      <!-- Google AdSense -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>

    </head>
    <body>
        <h1> ليجــــــا شـــوت </h1>
        <div id="tabs">
            <button class="tab-button active" onclick="filterMatches('all')">الكل</button>
            <button class="tab-button" onclick="filterMatches('inprogress')">جارية</button>
            <button class="tab-button" onclick="filterMatches('scheduled')">قادمة</button>
            <button class="tab-button" onclick="filterMatches('finished')">منتهية</button>
            <button class="tab-button" onclick="filterMatches('cancelled')">ملغاة</button>
        </div>
        <div id="matches-container"></div>

        <footer>
            <div class="footer-links">
                <a href="privacy.html">سياسة الخصوصية</a>
                <a href="terms.html">شروط الاستخدام</a>
                <a href="about.html">عن الموقع</a>
            </div>
            <div class="copyright">
                &copy; 2023 ليجا شوت. جميع الحقوق محفوظة.
            </div>
        </footer>

        <script>
            // تخزين المباريات بشكل عام للتصفية لاحقاً
            let allMatches = [];
            
            // قوائم التصنيف حسب الأولوية
            const continentalLeagues = [
                // البطولات القارية الأوروبية
                'UEFA Champions League',
                'UEFA Europa League',
                'UEFA Europa Conference League',
                'UEFA Nations League',
                
                // البطولات القارية الأفريقية
                'CAF Champions League',
                'CAF Confederation Cup',
                'Africa Cup of Nations'
            ];
            
            const topEuropeanLeagues = [
                'Premier League',         // إنجلترا
                'La Liga',                // إسبانيا
                'Ligue 1',                // فرنسا
                'Serie A',                // إيطاليا
                'Bundesliga',             // ألمانيا
                'Primeira Liga',          // البرتغال
                'Eredivisie',             // هولندا
                'Belgian Pro League'      // بلجيكا
            ];
            
            const africanLeagues = [
                'Egyptian Premier League',
                'Algerian Ligue 1',
                'Tunisian Ligue 1',
                'Botola Pro',
                'South African Premier Division',
                'Nigerian Professional Football League'
            ];
            
            const otherEuropeanLeagues = [
                'Scottish Premiership',
                'Russian Premier League',
                'Ukrainian Premier League',
                'Swiss Super League',
                'Austrian Bundesliga',
                'Danish Superliga',
                'Norwegian Eliteserien',
                'Swedish Allsvenskan',
                'Polish Ekstraklasa',
                'Greek Super League',
                'Czech First League',
                'Croatian First Football League',
                'Serbian SuperLiga'
            ];

            // دالة للحصول على التاريخ الحالي وتنسيقه
            function getCurrentDate() {
                const today = new Date();
                const year = today.getFullYear();
                const month = String(today.getMonth() + 1).padStart(2, '0');
                const day = String(today.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }

            // دالة لجلب بيانات المباريات
            async function fetchMatches() {
                const currentDate = getCurrentDate();
                const apiKey = '376800a4f1a5582465b88e9c37d3f326';
                const url = `https://v3.football.api-sports.io/fixtures?date=${currentDate}`;
                
                try {
                    const response = await fetch(url, {
                        headers: {
                            'x-rapidapi-key': apiKey,
                            'x-rapidapi-host': 'v3.football.api-sports.io'
                        }
                    });
                    const data = await response.json();
                    allMatches = data.response;
                    displayMatches(allMatches);
                } catch (error) {
                    console.error('Error fetching matches:', error);
                    document.getElementById('matches-container').innerHTML = 
                        '<div class="error">Failed to load matches. Please try again later.</div>';
                }
            }

            // دالة لتصفية المباريات حسب الحالة
            function filterMatches(status) {
                // تحديث الأزرار النشطة
                document.querySelectorAll('.tab-button').forEach(button => {
                    button.classList.remove('active');
                });
                event.target.classList.add('active');
                
                if (status === 'all') {
                    displayMatches(allMatches);
                    return;
                }
                
                const filteredMatches = allMatches.filter(match => {
                    const matchStatus = getStatusClass(match.fixture.status.short);
                    return matchStatus === `status-${status}`;
                });
                
                displayMatches(filteredMatches);
            }

            // دالة لترتيب المباريات حسب الأولوية
            function sortMatchesByPriority(matches) {
                return matches.sort((a, b) => {
                    const aLeague = a.league.name;
                    const bLeague = b.league.name;
                    
                    // تحديد أولوية كل دوري
                    const getPriority = (league) => {
                        if (continentalLeagues.includes(league)) return 1;
                        if (topEuropeanLeagues.includes(league)) return 2;
                        if (africanLeagues.includes(league)) return 3;
                        if (otherEuropeanLeagues.includes(league)) return 4;
                        return 5;
                    };
                    
                    return getPriority(aLeague) - getPriority(bLeague);
                });
            }

            // دالة لعرض المباريات على شكل كروت
            function displayMatches(matches) {
                const container = document.getElementById('matches-container');
                
                if (!matches || matches.length === 0) {
                    container.innerHTML = '<div class="no-matches">لا توجد مباريات لهذا اليوم.</div>';
                    return;
                }
                
                // ترتيب المباريات حسب الأولوية
                const sortedMatches = sortMatchesByPriority(matches);
                
                // تجميع المباريات حسب الدوري
                const matchesByLeague = {};
                sortedMatches.forEach(match => {
                    const leagueName = match.league.name;
                    if (!matchesByLeague[leagueName]) {
                        matchesByLeague[leagueName] = [];
                    }
                    matchesByLeague[leagueName].push(match);
                });
                
                // عرض المباريات
                let html = `<div class="date-header">مباريات يوم ${getCurrentDate()}</div>`;
                
                for (const league in matchesByLeague) {
                    // الحصول على بيانات البطولة والدولة
                    const firstMatch = matchesByLeague[league][0];
                    const country = firstMatch.league.country;
                    const countryFlag = firstMatch.league.flag || '';
                    const leagueLogo = firstMatch.league.logo || '';
                    const leagueType = firstMatch.league.type || 'بطولة';
                    
                    // تحديد كلاس خاص حسب الأولوية
                    const leagueClass = continentalLeagues.includes(league) ? 'continental-league' : 
                                      topEuropeanLeagues.includes(league) ? 'top-european-league' :
                                      africanLeagues.includes(league) ? 'african-league' : 'other-league';
                    
                    html += `
                        <div class="league-header ${leagueClass}">
                            <div class="league-info">
                                ${leagueLogo ? `<img src="${leagueLogo}" alt="${league}" class="league-logo">` : ''}
                                <span class="league-name">${league}</span>
                                <span class="league-type">${leagueType}</span>
                            </div>
                            <div class="country-info">
                                ${countryFlag ? `<img src="${countryFlag}" alt="${country}" class="country-flag">` : ''}
                                <span class="country-name">${country}</span>
                            </div>
                        </div>`;
                    
                    matchesByLeague[league].forEach(match => {
                        const matchTime = new Date(match.fixture.timestamp * 1000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                        const statusClass = getStatusClass(match.fixture.status.short);
                        
                        html += `
                            <div class="match-card ${statusClass}" onclick="openMatchDetails(${match.fixture.id})">
                                <div class="teams">
                                    <div class="team">
                                        <img src="${match.teams.home.logo}" alt="${match.teams.home.name}" class="team-logo">
                                        <span class="team-name">${match.teams.home.name}</span>
                                    </div>
                                    <div class="vs">
                                        <div class="score">${match.goals.home} - ${match.goals.away}</div>
                                        <div>VS</div>
                                    </div>
                                    <div class="team">
                                        <img src="${match.teams.away.logo}" alt="${match.teams.away.name}" class="team-logo">
                                        <span class="team-name">${match.teams.away.name}</span>
                                    </div>
                                </div>
                                <div class="match-info">
                                    <span class="match-time">${matchTime}</span>
                                    <span class="match-venue">${match.fixture.venue.name}</span>
                                </div>
                                <div class="match-status ${statusClass}">
                                    ${match.fixture.status.long}
                                </div>
                            </div>
                        `;
                    });
                }
                
                container.innerHTML = html;
            }

            // دالة لفتح تفاصيل المباراة في صفحة جديدة
            function openMatchDetails(fixtureId) {
                window.open(`match-details.html?id=${fixtureId}`, '_blank');
            }

            // دالة للحصول على كلاس حالة المباراة
            function getStatusClass(status) {
                const statusMap = {
                    'FT': 'finished',
                    'HT': 'inprogress',
                    '1H': 'inprogress',
                    '2H': 'inprogress',
                    'ET': 'inprogress',
                    'BT': 'inprogress',
                    'P': 'inprogress',
                    'SUSP': 'inprogress',
                    'INT': 'inprogress',
                    'NS': 'scheduled',
                    'TBD': 'scheduled',
                    'PST': 'postponed',
                    'CANC': 'cancelled',
                    'ABD': 'cancelled',
                    'AWD': 'cancelled',
                    'WO': 'cancelled'
                };
                return `status-${statusMap[status] || 'scheduled'}`;
            }

            // جلب المباريات عند تحميل الصفحة
            document.addEventListener('DOMContentLoaded', fetchMatches);
        </script>
        
        <style>
            #tabs {
                display: flex;
                justify-content: center;
                margin: 20px 0;
                flex-wrap: wrap;
            }
            
            .tab-button {
                padding: 8px 16px;
                margin: 0 5px;
                background-color: #f0f0f0;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-weight: bold;
                transition: all 0.3s;
                color: black;
            }
            
            .tab-button:hover {
                background-color: #ddd;
            }
            
            .tab-button.active {
                background-color: #4CAF50;
                color: white;
            }
            
            .match-card {
                color: black;
                margin-bottom: 15px;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
            
            .team-name, .vs, .score, .match-time, .match-venue {
                color: black !important;
            }
            
            .match-status {
                color: white !important;
                padding: 5px;
                text-align: center;
                font-weight: bold;
            }
            
            .status-finished {
                background-color: #4CAF50;
            }
            
            .status-inprogress {
                background-color: #2196F3;
            }
            
            .status-scheduled {
                background-color: #ff9800;
            }
            
            .status-cancelled {
                background-color: #f44336;
            }
            
            .status-postponed {
                background-color: #9e9e9e;
            }
            
            .date-header {
                text-align: center;
                font-size: 1.3em;
                margin: 20px 0;
                color: #333;
                font-weight: bold;
            }
            
            .league-header {
                color: black;
                font-weight: bold;
                margin: 15px 0 8px 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 15px;
                border-radius: 8px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            
            /* تنسيقات خاصة حسب الأولوية */
            .continental-league {
                background-color: #4a148c;
                color: white;
            }
            
            .top-european-league {
                background-color: #1a237e;
                color: white;
            }
            
            .african-league {
                background-color: #006064;
                color: white;
            }
            
            .other-league {
                background-color: #f8f9fa;
            }
            
            .league-info {
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .league-logo {
                width: 24px;
                height: 24px;
                object-fit: contain;
            }
            
            .league-name {
                font-size: 1.1em;
                font-weight: bold;
            }
            
            .league-type {
                font-size: 0.9em;
                color: #e0e0e0;
                background-color: rgba(0,0,0,0.2);
                padding: 2px 8px;
                border-radius: 12px;
            }
            
            .country-info {
                display: flex;
                align-items: center;
                gap: 8px;
            }
            
            .country-name {
                font-size: 1em;
                font-weight: bold;
            }
            
            .country-flag {
                width: 24px;
                height: 18px;
                border-radius: 3px;
                box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
            
            .no-matches {
                text-align: center;
                padding: 20px;
                font-size: 1.2em;
                color: #6c757d;
            }
            
            /* تنسيقات الكروت الداخلية */
            .teams {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 15px;
                background-color: white;
            }
            
            .team {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 30%;
            }
            
            .team-logo {
                width: 40px;
                height: 40px;
                margin-bottom: 5px;
            }
            
            .vs {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 30%;
            }
            
            .score {
                font-weight: bold;
                font-size: 1.2em;
                margin-bottom: 5px;
            }
            
            .match-info {
                display: flex;
                justify-content: space-between;
                padding: 8px 15px;
                background-color: #f5f5f5;
                font-size: 0.9em;
            }
        </style>
    </body>
</html>
