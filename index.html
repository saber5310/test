<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ليجـــا شـــوت</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        :root {
            --primary-color: #3f51b5;
            --secondary-color: #4CAF50;
            --accent-color: #FF5722;
            --africa-color: #8BC34A;
            --europe-color: #2196F3;
            --worldcup-color: #FFC107;
            --yesterday-color: #9C27B0;
            --tomorrow-color: #009688;
            --text-color: #333;
            --light-bg: #f5f5f5;
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            color: var(--text-color);
            margin: 0;
            padding: 0;
        }
        
        h1 {
            text-align: center;
            color: var(--primary-color);
            margin: 20px 0;
            font-size: 2.5rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* تبويبات الفترات الزمنية */
        .date-tabs {
            display: flex;
            justify-content: center;
            margin: 20px auto;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 95%;
        }
        
        .date-tab {
            padding: 12px 24px;
            background-color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            color: var(--text-color);
            box-shadow: var(--card-shadow);
        }
        
        .date-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .date-tab.active {
            transform: scale(1.05);
        }
        
        .date-tab.yesterday {
            border-right: 4px solid var(--yesterday-color);
        }
        
        .date-tab.today {
            border-right: 4px solid var(--primary-color);
        }
        
        .date-tab.tomorrow {
            border-right: 4px solid var(--tomorrow-color);
        }
        
        .date-tab.yesterday.active {
            background-color: var(--yesterday-color);
            color: white;
        }
        
        .date-tab.today.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .date-tab.tomorrow.active {
            background-color: var(--tomorrow-color);
            color: white;
        }
        
        /* تبويبات الدول والبطولات */
        .filter-tabs {
            display: flex;
            justify-content: center;
            margin: 15px auto;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 95%;
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 15px;
        }
        
        .filter-tab {
            padding: 10px 20px;
            background-color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            color: var(--text-color);
            box-shadow: var(--card-shadow);
        }
        
        .filter-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .filter-tab.active {
            transform: scale(1.03);
        }
        
        .filter-tab.country {
            color: var(--primary-color);
        }
        
        .filter-tab.country.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .filter-tab.continental.africa {
            border-left: 4px solid var(--africa-color);
        }
        
        .filter-tab.continental.europe {
            border-left: 4px solid var(--europe-color);
        }
        
        .filter-tab.continental.worldcup {
            border-left: 4px solid var(--worldcup-color);
        }
        
        .filter-tab.continental.active.africa {
            background-color: var(--africa-color);
            color: white;
        }
        
        .filter-tab.continental.active.europe {
            background-color: var(--europe-color);
            color: white;
        }
        
        .filter-tab.continental.active.worldcup {
            background-color: var(--worldcup-color);
            color: white;
        }
        
        /* تبويبات حالة المباريات */
        .status-tabs {
            display: flex;
            justify-content: center;
            margin: 15px auto;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 95%;
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 15px;
        }
        
        .status-tab {
            padding: 10px 20px;
            background-color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            color: var(--text-color);
            box-shadow: var(--card-shadow);
        }
        
        .status-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .status-tab.active {
            background-color: var(--secondary-color);
            color: white;
            transform: scale(1.03);
        }
        
        /* القائمة المنسدلة */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-btn {
            padding: 10px 20px;
            background-color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            color: var(--primary-color);
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .dropdown-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            background-color: white;
            min-width: 180px;
            box-shadow: var(--card-shadow);
            z-index: 10;
            border-radius: 10px;
            max-height: 400px;
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .dropdown-content a {
            color: var(--text-color);
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            transition: all 0.2s;
            border-bottom: 1px solid #eee;
        }
        
        .dropdown-content a:hover {
            background-color: var(--light-bg);
            padding-right: 20px;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        /* أقسام المباريات حسب التاريخ */
        .matches-section {
            margin-bottom: 40px;
        }
        
        .section-header {
            text-align: center;
            font-size: 1.4rem;
            margin: 30px 0 20px;
            color: var(--text-color);
            font-weight: 700;
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-header::after {
            content: '';
            display: block;
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            margin: 10px auto;
            border-radius: 3px;
        }
        
        .section-header.yesterday::after {
            background: linear-gradient(to right, var(--yesterday-color), var(--primary-color));
        }
        
        .section-header.tomorrow::after {
            background: linear-gradient(to right, var(--tomorrow-color), var(--primary-color));
        }
        
        /* كروت المباريات */
        #matches-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .league-header {
            color: white;
            font-weight: bold;
            margin: 20px 0 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary-color), #5c6bc0);
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease;
        }
        
        .league-header:hover {
            transform: translateY(-3px);
        }
        
        .league-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .league-logo {
            width: 28px;
            height: 28px;
            object-fit: contain;
        }
        
        .league-name {
            font-size: 1.1rem;
        }
        
        .league-type {
            font-size: 0.8rem;
            color: #e0e0e0;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 3px 10px;
            border-radius: 15px;
        }
        
        .country-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .country-name {
            font-size: 0.9rem;
        }
        
        .country-flag {
            width: 24px;
            height: 18px;
            border-radius: 3px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .match-card {
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            margin-bottom: 20px;
            transition: all 0.3s ease;
            animation: fadeInUp 0.5s ease;
            cursor: pointer;
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .match-card:active {
            animation: clickEffect 0.3s ease;
        }
        
        @keyframes clickEffect {
            0% { transform: scale(1); }
            50% { transform: scale(0.97); }
            100% { transform: scale(1); }
        }
        
        .match-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .teams {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
        }
        
        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 35%;
        }
        
        .team-logo {
            width: 50px;
            height: 50px;
            margin-bottom: 10px;
            object-fit: contain;
            transition: transform 0.3s ease;
        }
        
        .team:hover .team-logo {
            transform: scale(1.1);
        }
        
        .team-name {
            font-weight: 600;
            text-align: center;
            font-size: 0.95rem;
        }
        
        .vs {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 30%;
        }
        
        .score {
            font-weight: 700;
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .match-info {
            display: flex;
            justify-content: space-between;
            padding: 12px 20px;
            background-color: var(--light-bg);
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }
        
        .match-time {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .match-venue {
            color: #666;
        }
        
        .match-status {
            padding: 8px;
            text-align: center;
            font-weight: 700;
            color: white;
            border-radius: 0 0 12px 12px;
        }
        
        .status-finished {
            background-color: var(--secondary-color);
        }
        
        .status-inprogress {
            background-color: var(--accent-color);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .live-badge {
            background-color: #f44336;
            color: white;
            padding: 3px 8px;
            border-radius: 15px;
            font-size: 0.8rem;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.9; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .status-scheduled {
            background-color: #FF9800;
        }
        
        .status-cancelled {
            background-color: #9E9E9E;
        }
        
        .status-postponed {
            background-color: #607D8B;
        }
        
        .countdown {
            font-size: 0.9rem;
            font-weight: 600;
            color: white;
        }
        
        .no-matches {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #666;
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            margin: 20px;
        }
        
        .error {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: #f44336;
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            margin: 20px;
        }
        
        footer {
            background-color: var(--primary-color);
            color: white;
            padding: 30px 0;
            margin-top: 50px;
            text-align: center;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .footer-links a {
            color: white;
            text-decoration: none;
            transition: opacity 0.3s;
        }
        
        .footer-links a:hover {
            opacity: 0.8;
            text-decoration: underline;
        }
        
        .copyright {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* مؤشر التحميل */
        .loader-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .loader {
            width: 64px;
            height: 64px;
            position: relative;
            animation: rotate 1.5s ease-in infinite alternate;
        }
        
        .loader::before {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            color: var(--primary-color);
            background: currentColor;
            width: 64px;
            height: 32px;
            border-radius: 0 0 50px 50px;
        }
        
        .loader::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 10%;
            background: #fff;
            width: 8px;
            height: 64px;
            animation: rotate 1.2s linear infinite alternate-reverse;
        }
        
        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }
        
        .loader-text {
            position: absolute;
            bottom: 30%;
            left: 50%;
            transform: translateX(-50%);
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.2rem;
            text-align: center;
            width: 100%;
        }
    </style>
</head>
<body>
    <!-- مؤشر التحميل -->
    <div id="loader" class="loader-container" style="display: none;">
        <div class="loader"></div>
        <div class="loader-text">جاري تحميل المباريات...</div>
    </div>

    <h1 class="animate__animated animate__fadeIn">ليجـــا شـــوت</h1>
    
    <!-- تبويبات الفترات الزمنية -->
    <div class="date-tabs animate__animated animate__fadeInDown" id="date-tabs">
        <button class="date-tab yesterday" onclick="filterByDate('yesterday')">أمس</button>
        <button class="date-tab today active" onclick="filterByDate('today')">اليوم</button>
        <button class="date-tab tomorrow" onclick="filterByDate('tomorrow')">غداً</button>
    </div>
    
    <!-- تبويبات الفلترة الرئيسية -->
    <div class="filter-tabs animate__animated animate__fadeInDown" id="filter-tabs">
        <!-- تبويب الكل -->
        <button class="filter-tab country active" onclick="filterByType('all')">
            <span>الكل</span>
        </button>
        
        <!-- تبويبات البطولات القارية -->
        <button class="filter-tab continental africa" onclick="filterByType('africa')">
            <span>بطولات أفريقيا</span>
        </button>
        <button class="filter-tab continental europe" onclick="filterByType('europe')">
            <span>بطولات أوروبا</span>
        </button>
        <button class="filter-tab continental worldcup" onclick="filterByType('worldcup')">
            <span>كأس العالم</span>
        </button>
        
        <!-- تبويبات الدول الرئيسية -->
        <button class="filter-tab country" onclick="filterByType('Egypt')">
            <span>مصر</span>
        </button>
        <button class="filter-tab country" onclick="filterByType('England')">
            <span>إنجلترا</span>
        </button>
        <button class="filter-tab country" onclick="filterByType('Spain')">
            <span>إسبانيا</span>
        </button>

        <!-- القائمة المنسدلة للدول الأخرى -->
        <div class="dropdown">
            <button class="dropdown-btn">
                <span>دول أخرى</span>
                <span>▼</span>
            </button>
            <div class="dropdown-content">
                <a href="#" onclick="filterByType('Germany')">ألمانيا</a>
                <a href="#" onclick="filterByType('Italy')">إيطاليا</a>
                <a href="#" onclick="filterByType('France')">فرنسا</a>
                <a href="#" onclick="filterByType('Portugal')">البرتغال</a>
                <a href="#" onclick="filterByType('Morocco')">المغرب</a>
                <a href="#" onclick="filterByType('Algeria')">الجزائر</a>
                <a href="#" onclick="filterByType('Tunisia')">تونس</a>
            </div>
        </div>
    </div>
    
    <!-- تبويبات حالة المباريات -->
    <div class="status-tabs animate__animated animate__fadeInDown" id="status-tabs">
        <button class="status-tab active" onclick="filterByStatus('all')">الكل</button>
        <button class="status-tab" onclick="filterByStatus('inprogress')">جارية</button>
        <button class="status-tab" onclick="filterByStatus('scheduled')">قادمة</button>
        <button class="status-tab" onclick="filterByStatus('finished')">منتهية</button>
        <button class="status-tab" onclick="filterByStatus('cancelled')">ملغاة</button>
    </div>
    
    <div id="matches-container"></div>

    <footer class="animate__animated animate__fadeInUp">
        <div class="footer-links">
            <a href="privacy.html">سياسة الخصوصية</a>
            <a href="terms.html">شروط الاستخدام</a>
            <a href="about.html">عن الموقع</a>
        </div>
        <div class="copyright">
            &copy; 2023 ليجا شوت. جميع الحقوق محفوظة.
        </div>
    </footer>

    <script>
        // تخزين المباريات بشكل عام للتصفية لاحقاً
        let allMatches = {
            yesterday: [],
            today: [],
            tomorrow: []
        };
        let currentDateFilter = 'today';
        let currentFilterType = 'all';
        let currentStatusFilter = 'all';
        let countdownIntervals = {};
        
        // إعدادات نظام التخزين المؤقت
        const CACHE_CONFIG = {
            PREFIX: 'football_cache_',
            EXPIRY: 15 * 60 * 1000, // 15 دقيقة بالمللي ثانية
            API_KEY: '376800a4f1a5582465b88e9c37d3f326' // مفتاح API
        };

        // قوائم البطولات القارية
        const africanCompetitions = [
            'CAF Champions League',
            'CAF Confederation Cup',
            'Africa Cup of Nations',
            'African Nations Championship'
        ];
        
        const europeanCompetitions = [
            'UEFA Champions League',
            'UEFA Europa League',
            'UEFA Europa Conference League',
            'UEFA Nations League',
            'European Championship'
        ];
        
        const worldCupCompetitions = [
            'FIFA World Cup',
            'FIFA Club World Cup'
        ];
        
        // دالة الحصول على تاريخ معين بصيغة YYYY-MM-DD
        function getFormattedDate(daysOffset = 0) {
            const date = new Date();
            date.setDate(date.getDate() + daysOffset);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        // دالة جلب بيانات المباريات لليوم والأمس والغد
        async function fetchAllMatches() {
            showLoader();
            
            const dates = {
                yesterday: getFormattedDate(-1),
                today: getFormattedDate(),
                tomorrow: getFormattedDate(1)
            };
            
            try {
                // إيقاف جميع العدادات السابقة
                Object.values(countdownIntervals).forEach(interval => clearInterval(interval));
                countdownIntervals = {};
                
                // جلب المباريات لكل تاريخ
                for (const [period, date] of Object.entries(dates)) {
                    const cachedData = getFromCache(date);
                    
                    if (cachedData) {
                        allMatches[period] = cachedData;
                    } else {
                        await fetchAndCacheMatches(period, date);
                    }
                }
                
                applyFilters();
                hideLoader();
                
                // جدولة التحديث التلقائي كل دقيقة
                setTimeout(fetchAllMatches, 60000);
            } catch (error) {
                console.error('Error fetching matches:', error);
                hideLoader();
                document.getElementById('matches-container').innerHTML = 
                    '<div class="error">فشل تحميل المباريات. يرجى المحاولة لاحقاً.</div>';
            }
        }

        // دالة جلب المباريات من API وحفظها في التخزين المؤقت
        async function fetchAndCacheMatches(period, date) {
            const url = `https://v3.football.api-sports.io/fixtures?date=${date}`;
            const response = await fetch(url, {
                headers: {
                    'x-rapidapi-key': CACHE_CONFIG.API_KEY,
                    'x-rapidapi-host': 'v3.football.api-sports.io'
                }
            });
            
            if (!response.ok) {
                throw new Error(`خطأ في API: ${response.status}`);
            }
            
            const data = await response.json();
            const matches = data.response || [];
            
            allMatches[period] = matches;
            saveToCache(date, matches);
        }

        // دالة حفظ البيانات في التخزين المؤقت
        function saveToCache(key, data) {
            const now = new Date();
            const item = {
                data: data,
                timestamp: now.getTime(),
                expiry: now.getTime() + CACHE_CONFIG.EXPIRY
            };
            localStorage.setItem(`${CACHE_CONFIG.PREFIX}${key}`, JSON.stringify(item));
        }

        // دالة استرجاع البيانات من التخزين المؤقت
        function getFromCache(key) {
            const itemStr = localStorage.getItem(`${CACHE_CONFIG.PREFIX}${key}`);
            if (!itemStr) return null;
            
            const item = JSON.parse(itemStr);
            const now = new Date();
            
            // التحقق من صلاحية البيانات
            if (now.getTime() > item.expiry) {
                localStorage.removeItem(`${CACHE_CONFIG.PREFIX}${key}`);
                return null;
            }
            
            return item.data;
        }

        // دالة عرض مؤشر التحميل
        function showLoader() {
            document.getElementById('loader').style.display = 'flex';
        }

        // دالة إخفاء مؤشر التحميل
        function hideLoader() {
            document.getElementById('loader').style.display = 'none';
        }

        // دالة التصفية حسب التاريخ
        function filterByDate(period) {
            currentDateFilter = period;
            
            // تحديث الأزرار النشطة
            document.querySelectorAll('.date-tab').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            applyFilters();
        }
        
        // دالة التصفية حسب النوع (دولة/قارة/كأس العالم)
        function filterByType(type) {
            currentFilterType = type;
            
            // تحديث الأزرار النشطة
            document.querySelectorAll('.filter-tab').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            applyFilters();
        }
        
        // دالة التصفية حسب حالة المباراة
        function filterByStatus(status) {
            currentStatusFilter = status;
            
            // تحديث الأزرار النشطة
            document.querySelectorAll('.status-tab').forEach(button => {
                button.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            applyFilters();
        }
        
        // دالة تطبيق جميع الفلاتر
        function applyFilters() {
            // الحصول على المباريات للفترة الزمنية المحددة
            let filteredMatches = allMatches[currentDateFilter];
            
            // التصفية حسب النوع
            if (currentFilterType !== 'all') {
                filteredMatches = filteredMatches.filter(match => {
                    if (currentFilterType === 'africa') {
                        return africanCompetitions.includes(match.league.name);
                    } else if (currentFilterType === 'europe') {
                        return europeanCompetitions.includes(match.league.name);
                    } else if (currentFilterType === 'worldcup') {
                        return worldCupCompetitions.includes(match.league.name);
                    } else {
                        return match.league.country === currentFilterType;
                    }
                });
            }
            
            // التصفية حسب الحالة
            if (currentStatusFilter !== 'all') {
                filteredMatches = filteredMatches.filter(match => {
                    const matchStatus = getStatusClass(match.fixture.status.short);
                    return matchStatus === `status-${currentStatusFilter}`;
                });
            }
            
            displayMatches(filteredMatches);
        }
        
        // دالة عرض المباريات
        function displayMatches(matches) {
            const container = document.getElementById('matches-container');
            
            if (!matches || matches.length === 0) {
                container.innerHTML = '<div class="no-matches">لا توجد مباريات في هذه الفترة.</div>';
                return;
            }
            
            // تجميع المباريات حسب الدوري
            const matchesByLeague = {};
            matches.forEach(match => {
                const leagueName = match.league.name;
                if (!matchesByLeague[leagueName]) {
                    matchesByLeague[leagueName] = [];
                }
                matchesByLeague[leagueName].push(match);
            });
            
            // عرض المباريات
            let html = '';
            
            for (const league in matchesByLeague) {
                const firstMatch = matchesByLeague[league][0];
                const country = firstMatch.league.country;
                const countryFlag = firstMatch.league.flag || '';
                const leagueLogo = firstMatch.league.logo || '';
                const leagueType = firstMatch.league.type || 'بطولة';
                
                html += `
                    <div class="league-header">
                        <div class="league-info">
                            ${leagueLogo ? `<img src="${leagueLogo}" alt="${league}" class="league-logo">` : ''}
                            <span class="league-name">${league}</span>
                            <span class="league-type">${leagueType}</span>
                        </div>
                        <div class="country-info">
                            ${countryFlag ? `<img src="${countryFlag}" alt="${country}" class="country-flag">` : ''}
                            <span class="country-name">${country}</span>
                        </div>
                    </div>`;
                
                matchesByLeague[league].forEach(match => {
                    const matchTime = new Date(match.fixture.timestamp * 1000);
                    const statusClass = getStatusClass(match.fixture.status.short);
                    const statusLong = match.fixture.status.long;
                    
                    let timeDisplay = matchTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    let extraInfo = '';
                    
                    // تحديد النتيجة المعروضة
                    let scoreDisplay = 'VS';
                    let showVsText = true;
                    
                    if (match.fixture.status.short === 'NS' || match.fixture.status.short === 'TBD') {
                        scoreDisplay = 'لم تبدأ';
                        showVsText = false;
                    } else if (match.goals.home !== null && match.goals.away !== null) {
                        scoreDisplay = `${match.goals.home} - ${match.goals.away}`;
                        showVsText = false;
                    }
                    
                    if (statusClass === 'status-scheduled') {
                        const countdownId = `countdown-${match.fixture.id}`;
                        extraInfo = `<div class="countdown" id="${countdownId}"></div>`;
                        startCountdown(match.fixture.timestamp, countdownId);
                    } 
                    else if (statusClass === 'status-inprogress') {
                        const elapsedTime = match.fixture.status.elapsed || 0;
                        extraInfo = `<div class="live-badge">مباشر ${elapsedTime}'</div>`;
                    }
                    
                    html += `
                        <div class="match-card" onclick="openMatchDetails(${match.fixture.id})">
                            <div class="teams">
                                <div class="team">
                                    <img src="${match.teams.home.logo}" alt="${match.teams.home.name}" class="team-logo">
                                    <span class="team-name">${match.teams.home.name}</span>
                                </div>
                                <div class="vs">
                                    <div class="score">${scoreDisplay}</div>
                                    ${showVsText ? '<div>VS</div>' : ''}
                                </div>
                                <div class="team">
                                    <img src="${match.teams.away.logo}" alt="${match.teams.away.name}" class="team-logo">
                                    <span class="team-name">${match.teams.away.name}</span>
                                </div>
                            </div>
                            <div class="match-info">
                                <span class="match-time">${timeDisplay}</span>
                                <span class="match-venue">${match.fixture.venue.name}</span>
                            </div>
                            <div class="match-status ${statusClass}">
                                ${statusClass === 'status-inprogress' ? extraInfo : statusLong}
                                ${statusClass === 'status-scheduled' ? extraInfo : ''}
                            </div>
                        </div>`;
                });
            }
            
            container.innerHTML = html;
        }
        
        // دالة العد التنازلي
        function startCountdown(timestamp, elementId) {
            const matchTime = new Date(timestamp * 1000).getTime();
            
            countdownIntervals[elementId] = setInterval(() => {
                const now = new Date().getTime();
                const distance = matchTime - now;
                
                if (distance < 0) {
                    clearInterval(countdownIntervals[elementId]);
                    const element = document.getElementById(elementId);
                    if (element) {
                        element.innerHTML = "بدأت المباراة";
                    }
                    return;
                }
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                
                let countdownText = "";
                if (days > 0) {
                    countdownText += `${days} يوم `;
                }
                if (hours > 0 || days > 0) {
                    countdownText += `${Math.floor(hours)} ساعة `;
                }
                countdownText += `${Math.floor(minutes)} دقيقة`;
                
                const countdownElement = document.getElementById(elementId);
                if (countdownElement) {
                    countdownElement.innerHTML = countdownText;
                }
            }, 1000);
        }
        
        // دالة فتح تفاصيل المباراة
        function openMatchDetails(fixtureId) {
            const card = event.currentTarget;
            card.style.animation = 'none';
            void card.offsetWidth;
            card.style.animation = 'clickEffect 0.3s ease';
            
            setTimeout(() => {
                window.open(`match-details.html?id=${fixtureId}`, '_blank');
            }, 300);
        }
        
        // دالة تحديد حالة المباراة
        function getStatusClass(status) {
            const statusMap = {
                'FT': 'finished',
                'HT': 'inprogress',
                '1H': 'inprogress',
                '2H': 'inprogress',
                'ET': 'inprogress',
                'BT': 'inprogress',
                'P': 'inprogress',
                'SUSP': 'inprogress',
                'INT': 'inprogress',
                'NS': 'scheduled',
                'TBD': 'scheduled',
                'PST': 'postponed',
                'CANC': 'cancelled',
                'ABD': 'cancelled',
                'AWD': 'cancelled',
                'WO': 'cancelled'
            };
            return `status-${statusMap[status] || 'scheduled'}`;
        }
        
        // تحميل المباريات عند بدء التشغيل
        document.addEventListener('DOMContentLoaded', fetchAllMatches);
    </script>
</body>
</html>
